<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard - Sistema de Control de Aseo</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='ICON/logopestana.ico') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        body {
            min-height: 100vh;
            margin: 0;
            background-color: #f8fafc;
        }

        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(45deg, #0f172a, #1e293b);
            min-height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            padding: 1.5rem;
            color: white;
            z-index: 1000;
        }

        .sidebar-header {
            text-align: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1.5rem;
        }

        .sidebar-header img {
            max-width: 110px !important;
            width: 110px !important;
            height: 110px !important;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            margin-bottom: 0.5rem;
            background: #fff;
            border: 2px solid #3b82f6;
        }

        .sidebar-header h4 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: #fff;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.7) !important;
            padding: 0.8rem 1rem;
            border-radius: 12px;
            margin: 0.3rem 0;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(59, 130, 246, 0.1);
            color: white !important;
            transform: translateX(5px);
        }

        .nav-link i {
            margin-right: 0.8rem;
            font-size: 1.1rem;
        }

        .main-content {
            margin-left: var(--sidebar-width);
            padding: 2rem;
        }

        .header {
            height: var(--header-height);
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            padding: 0 2rem;
            margin-bottom: 2rem;
        }

        .user-info {
            position: absolute;
            bottom: 1.5rem;
            width: calc(var(--sidebar-width) - 3rem);
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            text-align: center;
        }

        .user-info i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
            padding: 0.6rem;
            border-radius: 10px;
            color: white;
            margin-top: 0.8rem;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .stat-card {
            background: linear-gradient(45deg, #3b82f6, #9333ea);
            color: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-card i {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .stat-card h3 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            margin: 0;
            opacity: 0.8;
        }

        .activity-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .activity-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        .mes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 32px;
            margin-bottom: 32px;
        }

        .mes-card {
            position: relative;
            border-radius: 18px;
            overflow: hidden;
            height: 170px;
            box-shadow: 0 4px 18px rgba(59,130,246,0.10);
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: flex-end;
            transition: transform 0.18s, box-shadow 0.18s;
            cursor: pointer;
            border: 2px solid rgba(59,130,246,0.08);
        }

        .mes-card:hover {
            transform: scale(1.045) translateY(-4px);
            box-shadow: 0 10px 32px rgba(59,130,246,0.18);
            z-index: 2;
        }

        .mes-card-label {
            width: 100%;
            background: rgba(255,255,255,0.82);
            padding: 18px 0 12px 0;
            text-align: center;
            border-bottom-left-radius: 18px;
            border-bottom-right-radius: 18px;
            position: absolute;
            bottom: 0;
            left: 0;
        }

        .mes-card-label span {
            color: #22223b;
            font-weight: 700;
            font-size: 1.35em;
            letter-spacing: 1px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .titulo-moderno {
            font-family: 'Poppins', 'Segoe UI', Arial, sans-serif;
            font-size: 2.7rem;
            font-weight: 800;
            letter-spacing: 1.5px;
            color: #18181b;
            line-height: 1.1;
            margin-bottom: 0.5rem;
            margin-top: 0.5rem;
            text-shadow: 0 4px 24px rgba(59,130,246,0.08);
        }

        .titulo-moderno .anio {
            font-size: 2.2rem;
            font-weight: 900;
            margin-left: 8px;
            color: #2563eb;
        }

        .titulo-moderno .subtitulo {
            display: block;
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 0.5rem;
            letter-spacing: 0.5px;
            color: #18181b;
        }

        .alert {
            border-radius: 12px;
            border: none;
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            font-weight: 500;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .alert-danger {
            background: linear-gradient(45deg, #fef2f2, #fee2e2);
            color: #dc2626;
            border-left: 4px solid #dc2626;
        }

        .alert-success {
            background: linear-gradient(45deg, #f0fdf4, #dcfce7);
            color: #16a34a;
            border-left: 4px solid #16a34a;
        }

        .alert-info {
            background: linear-gradient(45deg, #eff6ff, #dbeafe);
            color: #2563eb;
            border-left: 4px solid #2563eb;
        }

        .alert i {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        .btn-close {
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .btn-close:hover {
            opacity: 1;
        }

        /* Estilos para alertas emergentes flotantes */
        .floating-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            max-width: 400px;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
            border: none;
            transform: translateX(100%);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            backdrop-filter: blur(10px);
            display: none; /* Inicialmente oculta */
        }

        .floating-alert.show {
            transform: translateX(0);
        }

        .floating-alert.hide {
            transform: translateX(100%);
        }

        .floating-alert-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .floating-alert-title {
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .floating-alert-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-alert-close:hover {
            opacity: 1;
        }

        .floating-alert-message {
            font-size: 0.95rem;
            line-height: 1.4;
            opacity: 0.95;
        }

        .floating-alert-icon {
            font-size: 1.3rem;
        }

        /* Estilos para el botón flotante del desarrollador */
        .developer-info {
            position: absolute;
            top: 50%;
            left: calc(100% + 15px);
            transform: translateY(-50%);
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            opacity: 0;
            transition: all 0.3s ease;
            min-width: 300px;
            max-width: 350px;
            border: 1px solid #e2e8f0;
            pointer-events: none;
        }

        .developer-content {
            padding: 0;
        }

        .developer-header {
            background: linear-gradient(45deg, #3b82f6, #9333ea);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 15px 15px 0 0;
            display: flex;
            align-items: center;
            font-weight: 600;
            font-size: 1rem;
        }

        .developer-header i {
            margin-right: 0.5rem;
        }

        .developer-body {
            padding: 1.5rem;
            text-align: center;
        }

        .developer-body h5 {
            color: #1e293b;
            font-weight: 700;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .developer-body p {
            color: #64748b;
            margin-bottom: 0.6rem;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .developer-body i {
            color: #3b82f6;
            width: 16px;
        }

        /* Flecha del tooltip */
        .developer-info::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid white;
        }

        /* Estilos para el Asistente Virtual 3D */
        .virtual-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9998;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 120px;
            height: 120px;
        }

        .virtual-assistant:hover {
            transform: scale(1.1);
        }

        .assistant-img {
            width: 120px;
            height: 120px;
            position: relative;
            animation: assistantFloat 3s ease-in-out infinite;
        }

        .assistant-bubble {
            position: absolute;
            bottom: 100%;
            right: 10px;
            background: white;
            padding: 8px 12px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            white-space: nowrap;
            font-size: 15px;
            color: #374151;
            font-weight: 500;
            opacity: 0;
            transform: translateY(10px);
            animation: bubbleShow 3s ease-in-out infinite;
        }

        .assistant-bubble::after {
            content: '';
            position: absolute;
            top: 100%;
            right: 20px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid white;
        }

        /* Animaciones */
        @keyframes assistantFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes bubbleShow {
            0%, 70%, 100% { 
                opacity: 0; 
                transform: translateY(10px); 
            }
            10%, 60% { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        /* Efecto de brillo */
        .assistant-img::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 20%;
            width: 20%;
            height: 20%;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes shine {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }

        /* Asistente Virtual 3D con imagen personalizada y espectro animado */
        .virtual-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9998;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 120px;
            height: 120px;
        }

        .assistant-spectrum {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border-radius: 100%;
        }

        .spectrum-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: linear-gradient(to top, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0));
            animation: spectrumAnimation 3s linear infinite;
        }

        .bar1 {
            height: 20%;
        }

        .bar2 {
            height: 40%;
        }

        .bar3 {
            height: 60%;
        }

        .bar4 {
            height: 80%;
        }

        .bar5 {
            height: 100%;
        }

        @keyframes spectrumAnimation {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(-100%);
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <img src="{{ url_for('static', filename='LOGO Grupo Servis Aseo S.L/Logo Moda Femenina Minimalista Negro y Rosa.png') }}" alt="Grupo Servis Aseo S.L" style="max-width: 70px; width: 100%; height: auto; margin-bottom: 0.5rem;">
            <h4>Control de Aseo</h4>
        </div>
        <nav class="mt-4">
            <a href="#" class="nav-link active">
                <i class="fas fa-home"></i> Inicio
            </a>
            <a href="{{ url_for('programacion') }}" class="nav-link">
                <i class="fas fa-calendar"></i> Programación
            </a>
            <a href="{{ url_for('admin_panel') }}" class="nav-link">
                <i class="fas fa-cog"></i> Admin
            </a>
            <div class="nav-link" style="color: #6c757d; font-size: 0.9rem; text-align: center; padding: 10px 15px; border-top: 1px solid #dee2e6; margin-top: 10px; cursor: pointer; position: relative;" onclick="showDeveloperInfo()">
                <i class="fas fa-code"></i> Versión 2.0
                <!-- Botón flotante del desarrollador -->
                <div id="developerInfo" class="developer-info" style="display: none;">
                    <div class="developer-content">
                        <div class="developer-header">
                            <i class="fas fa-code"></i>
                            <span>Información del Desarrollador</span>
                        </div>
                        <div class="developer-body">
                            <h5><i class="fas fa-building"></i> Desarrollado por JL DIGITAL S.A</h5>
                            <p><i class="fas fa-info-circle"></i> Sistema de Gestión de Planillas de Aseo</p>
                            <p><i class="fas fa-version"></i> Versión 2.0</p>
                            <p><i class="fas fa-calendar"></i> 2025</p>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <div class="user-info">
            <i class="fas fa-user-circle"></i>
            <p class="mb-1">{{ current_user.username }}</p>
            <a href="{{ url_for('logout') }}" class="btn logout-btn">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </a>
        </div>
    </div>

    <div class="main-content">
        {% if important_msg and important_msg.is_active and important_msg.content.strip() %}
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
        <div style="width:100%;overflow:hidden;margin-bottom:1.5rem;">
          <div id="marqueeMsg" style="white-space:nowrap;font-size:1.32rem;font-family:'Montserrat', 'Poppins', 'Inter', 'Segoe UI', Arial, sans-serif;font-weight:700;letter-spacing:0.02em;animation:marquee-ltr 12s linear infinite;">
            {{ important_msg.content|safe }}
          </div>
        </div>
        <style>
        @keyframes marquee-ltr {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }
        </style>
        {% endif %}

        <div class="header">
            <h4 class="mb-0">Panel de Control</h4>
        </div>

        <!-- Sistema de alertas flotantes -->
        <div id="floatingAlertsContainer"></div>

        <div class="welcome-section">
            <!-- Título moderno -->
            <div class="row">
                <div class="col-12">
                    <h1 class="titulo-moderno mb-4 mt-2 text-center">
                        <span>Registro Diario</span> <span class="anio">2025</span><br>
                        <span class="subtitulo">Salud Casanare y Laboratorio</span>
                    </h1>
                </div>
            </div>
            {% if not section_2025_enabled %}
            <div class="row">
                <div class="col-12">
                    <div class="alert alert-info text-center" style="font-size:1.2rem; font-weight:600;">
                        <i class="fas fa-tools me-2"></i>{{ section_2025_message }}
                    </div>
                </div>
            </div>
            {% endif %}
            <!-- Fin título moderno -->

            <!-- Pestañas de los meses organizadas en grid -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="mes-grid">
                        {% for mes in meses %}
                        <div>
                            {% if section_2025_enabled %}
                            <a href="{{ url_for('ver_mes', mes=loop.index) }}" style="text-decoration:none;">
                                <div class="mes-card" style="background-image:url('{{ url_for('static', filename='images/meses/' ~ mes.archivo) }}');">
                                    <div class="mes-card-label">
                                        <span>{{ mes.nombre }}</span>
                                    </div>
                                </div>
                            </a>
                            {% else %}
                            <div class="mes-card" style="background-image:url('{{ url_for('static', filename='images/meses/' ~ mes.archivo) }}'); opacity:0.5; filter: grayscale(0.7); cursor:not-allowed;">
                                <div class="mes-card-label">
                                    <span>{{ mes.nombre }}</span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Fin pestañas meses -->
            
            <!-- Línea divisora visual -->
            <div class="row mb-4">
                <div class="col-12">
                    <hr style="border-top: 3px solid #2563eb; border-radius: 2px; margin: 40px 0;">
                </div>
            </div>
            <!-- Fin línea divisora visual -->

            <!-- Título moderno 2026 -->
            <div class="row">
                <div class="col-12">
                    <h1 class="titulo-moderno mb-4 mt-2 text-center">
                        <span>Registro Diario</span> <span class="anio">{{ year_2026 }}</span><br>
                        <span class="subtitulo">Salud Casanare y Laboratorio</span>
                    </h1>
                </div>
            </div>
            <!-- Fin título moderno 2026 -->

            <!-- Pestañas de los meses 2026 organizadas en grid -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="mes-grid">
                        {% for mes in meses_2026 %}
                        <div>
                            <a href="{{ url_for('ver_mes_2026', mes=loop.index) }}" style="text-decoration:none;">
                                <div class="mes-card" style="background-image:url('{{ url_for('static', filename='images/meses/' ~ mes.archivo) }}');">
                                    <div class="mes-card-label">
                                        <span>{{ mes.nombre }}</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Fin pestañas meses 2026 -->
        </div>
    </div>

    <!-- Alerta emergente flotante -->
    <div id="floatingAlert" class="floating-alert">
        <div class="floating-alert-header">
            <div class="floating-alert-title">
                <i class="fas fa-exclamation-triangle floating-alert-icon"></i>
                Acceso Denegado
            </div>
            <button class="floating-alert-close" onclick="closeFloatingAlert()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="floating-alert-message" id="floatingAlertMessage">
            Solo los administradores pueden acceder a esta sección.
        </div>
    </div>

    <!-- Asistente Virtual 3D solo con imagen personalizada -->
    <div id="virtualAssistant" class="virtual-assistant" onclick="openWhatsApp()">
        <img src="{{ url_for('static', filename='images/asistente-3d.png') }}" alt="Asistente Virtual" class="assistant-img">
        <div class="assistant-bubble">
            <span>¿Necesitas ayuda?</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Función para mostrar alerta emergente
        function showFloatingAlert(message) {
            const alert = document.getElementById('floatingAlert');
            const messageElement = document.getElementById('floatingAlertMessage');
            
            // Asegurar que la alerta esté visible
            alert.style.display = 'block';
            
            if (messageElement) {
                messageElement.textContent = message;
            }
            
            // Resetear clases y mostrar
            alert.classList.remove('hide');
            alert.classList.add('show');
            
            // Auto-cerrar después de 5 segundos
            setTimeout(() => {
                closeFloatingAlert();
            }, 5000);
        }

        // Función para cerrar alerta emergente
        function closeFloatingAlert() {
            const alert = document.getElementById('floatingAlert');
            alert.classList.remove('show');
            alert.classList.add('hide');
            
            // Remover completamente después de la animación
            setTimeout(() => {
                alert.style.display = 'none';
            }, 400); // Tiempo de la transición CSS
        }

        // Función para mostrar alertas flotantes
        function showFloatingAlert(message, type = 'info') {
            // Crear el elemento de alerta
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = `
                top: 20px;
                right: 20px;
                z-index: 9999;
                min-width: 350px;
                max-width: 500px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                border: none;
                border-radius: 8px;
                animation: slideInRight 0.3s ease-out;
            `;
            
            // Definir iconos según el tipo
            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            else if (type === 'danger') icon = 'exclamation-triangle';
            else if (type === 'warning') icon = 'exclamation-circle';
            
            alertDiv.innerHTML = `
                <i class="fas fa-${icon} me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            // Agregar al contenedor de alertas
            const container = document.getElementById('floatingAlertsContainer');
            if (container) {
                container.appendChild(alertDiv);
            } else {
                document.body.appendChild(alertDiv);
            }
            
            // Auto-remover después de 5 segundos
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.style.animation = 'slideOutRight 0.3s ease-in';
                    setTimeout(() => {
                        if (alertDiv.parentNode) {
                            alertDiv.remove();
                        }
                    }, 300);
                }
            }, 5000);
        }

        // Agregar estilos CSS para las animaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Interceptar enlaces del admin para verificar acceso
        document.addEventListener('DOMContentLoaded', function() {
            // Convertir mensajes flash a alertas flotantes
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        showFloatingAlert('{{ message }}', '{{ "danger" if category == "error" else "success" if category == "success" else "warning" if category == "warning" else "info" }}');
                    {% endfor %}
                {% endif %}
            {% endwith %}

            const adminLinks = document.querySelectorAll('a[href*="admin"]');
            
            adminLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Hacer petición AJAX para verificar acceso
                    fetch(this.href)
                        .then(response => {
                            if (response.status === 403) {
                                return response.json();
                            }
                            // Si no hay error, redirigir normalmente
                            window.location.href = this.href;
                        })
                        .then(data => {
                            if (data && data.error) {
                                showFloatingAlert(data.error);
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            // En caso de error, intentar redirigir normalmente
                            window.location.href = this.href;
                        });
                });
            });
        });

        // Función para mostrar información del desarrollador
        function showDeveloperInfo() {
            const developerInfo = document.getElementById('developerInfo');
            developerInfo.style.display = 'block';
            setTimeout(() => {
                developerInfo.style.opacity = '1';
                developerInfo.style.transform = 'translateY(-50%)';
            }, 10);
            
            // Auto-cerrar después de 3 segundos
            setTimeout(() => {
                closeDeveloperInfo();
            }, 3000);
        }

        // Función para cerrar información del desarrollador
        function closeDeveloperInfo() {
            const developerInfo = document.getElementById('developerInfo');
            developerInfo.style.opacity = '0';
            developerInfo.style.transform = 'translateY(-50%) translateX(-10px)';
            setTimeout(() => {
                developerInfo.style.display = 'none';
            }, 300);
        }

        // Cerrar al hacer clic fuera del botón
        document.addEventListener('click', function(event) {
            const developerInfo = document.getElementById('developerInfo');
            const versionElement = document.querySelector('.nav-link[onclick="showDeveloperInfo()"]');
            
            if (developerInfo.style.display === 'block' && 
                !developerInfo.contains(event.target) && 
                !versionElement.contains(event.target)) {
                closeDeveloperInfo();
            }
        });

        // Función para abrir WhatsApp
        function openWhatsApp() {
            // Número de WhatsApp actualizado
            const phoneNumber = '573174847594'; // +57 317 484 7594
            const message = 'Hola, necesito ayuda con el sistema de planillas de aseo.';
            
            // Crear URL de WhatsApp
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            
            // Abrir WhatsApp en nueva pestaña
            window.open(whatsappUrl, '_blank');
            
            // Efecto visual al hacer clic
            const assistant = document.getElementById('virtualAssistant');
            assistant.style.transform = 'scale(0.9)';
            setTimeout(() => {
                assistant.style.transform = 'scale(1)';
            }, 150);
        }
    </script>
</body>
</html> 